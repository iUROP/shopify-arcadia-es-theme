<div class="i-header-menu">
  <div class="i-header-menu__toggler">
    <div class="re">
      <div class="ce">
        {% render 'icon-hamburger' %}
        {% render 'icon-close' %}
      </div>
    </div>
  </div>
  <nav class="i-header-menu__content slow_ani" style="top: {{ section.settings.container_height }}px;">
    <ul class="i-header-menu__content--items" role="list">
      {%- for link in section.settings.menu.links -%}
        <li class="i-header-menu__content--items__item">
          {%- if link.links != blank -%}
            <div class="item-details">
              <summary class="{% if link.child_active %} active{% endif %}">
                {{ link.title | escape }}
                {% render 'icon-arrow' %}
                {% render 'icon-caret' %}
              </summary>
              <div class="i-header-menu__content--items__item--submenu slow_ani" tabindex="-1">
                <ul class="i-header-menu__content--items__item--submenu--items" role="list" tabindex="-1">
                  <button class="i-header-menu__content--items__item--back" aria-expanded="true">
                    {% render 'icon-arrow' %}
                    {{ link.title | escape }}
                  </button>
                  {%- for childlink in link.links -%}
                    <li class="i-header-menu__content--items__item--submenu--items__item">
                      {%- if childlink.links == blank -%}
                        <a
                          href="{{ childlink.url }}"
                          class="i-header-menu__content--items__item--submenu--items__item--link {% if childlink.current %} active{% endif %}"
                          {% if childlink.current %}
                            aria-current="page"
                          {% endif %}
                        >
                          {{ childlink.title | escape }}
                        </a>
                      {%- else -%}
                        <div class="item-details">
                          <summary class="{% if link.child_active %} active{% endif %}">
                            {{ childlink.title | escape }}
                            {% render 'icon-arrow' %}
                            {% render 'icon-caret' %}
                          </summary>
                          <div class="i-header-menu__content--items__item--submenu--items__item--submenu slow_ani" tabindex="-1">
                            <ul class="i-header-menu__content--items__item--submenu--items__item--submenu--items" role="list" tabindex="-1">
                              <button class="i-header-menu__content--items__subitem--back" aria-expanded="true">
                                {% render 'icon-arrow' %}
                                {{ link.title | escape }}
                              </button>
                              {%- for grandchildlink in childlink.links -%}
                                <li class="i-header-menu__content--items__item--submenu--items__item--submenu--items__item">
                                  <a
                                    href="{{ grandchildlink.url }}"
                                    class="i-header-menu__content--items__item--submenu--items__item--submenu--items__item--link {% if grandchildlink.current %} active{% endif %}"
                                    {% if grandchildlink.current %}
                                      aria-current="page"
                                    {% endif %}
                                  >
                                    {{ grandchildlink.title | escape }}
                                  </a>
                                </li>
                              {%- endfor -%}

                            </ul>
                          </div>
                        </div>
                      {%- endif -%}
                    </li>
                  {%- endfor -%}
                </ul>
              </div>
            </div>
          {%- else -%}
            <a
              href="{{ link.url }}"
              class="i-header-menu__content--items__item--link {% if link.current %} active{% endif %}"
              {% if link.current %}
                aria-current="page"
              {% endif %}
            >
              {{ link.title | escape }}
            </a>
          {%- endif -%}
        </li>
      {%- endfor -%}
    </ul>
  </nav>
  <div class="i-header-menu__overlay slow_ani" style="top: {{ section.settings.container_height }}px;"></div>
</div>

<script>
  document.querySelector('.i-header-menu__toggler').addEventListener("click", function(){
    Permalink.openMenu()
  })
  document.querySelector('.i-header-menu__overlay').addEventListener("click", function(){
    Permalink.openMenu()
  })
</script>