{%- liquid
  assign should_show_background = false
  assign transparent_pages = section.settings.transparent_pages
  
  if section.settings.background_enabled
    case transparent_pages
      when 'none'
        assign should_show_background = true
      when 'home'
        if template.name == 'index'
          assign should_show_background = false
        else
          assign should_show_background = true
        endif
      when 'home_collection'
        if template.name == 'index' or template.name == 'collection'
          assign should_show_background = false
        else
          assign should_show_background = true
        endif
      when 'home_collection_product'
        if template.name == 'index' or template.name == 'collection' or template.name == 'product'
          assign should_show_background = false
        else
          assign should_show_background = true
        endif
      when 'all_except_cart'
        if template.name == 'cart' or template.name == 'checkout'
          assign should_show_background = true
        else
          assign should_show_background = false
        endif
      when 'all'
        assign should_show_background = false
    endcase
  endif
-%}

<header class="section-header{% if should_show_background %} has-background{% endif %}{% if template.name == 'index' and should_show_background == false %} is-transparent{% endif %}">
  <div class="i-header-container">
    <div class="i-header-container__content">
      
      {% comment %} LEFT: MENU TOGGLER & DESKTOP MENU {% endcomment %}
      <div class="i-header-container__content--menu">
        {%- if section.settings.menu != blank -%}
          {% render 'header-drawer' %}
        {%- endif -%}
      </div>

      {% comment %} CENTER: LOGO {% endcomment %}
      <div class="i-header-container__content--logo">
        <a href="{{ routes.root_url }}" class="header__logo">
          {% if section.settings.logo_header != blank %}
            <img src="{{ section.settings.logo_header | image_url: width: 200 }}" alt="{{ shop.name }}" class="logo-light" width="80" height="auto" />
          {% endif %}
          {% if section.settings.logo_header_dark != blank %}
            <img src="{{ section.settings.logo_header_dark | image_url: width: 200 }}" alt="{{ shop.name }}" class="logo-dark" width="80" height="auto" />
          {% endif %}
          {% if section.settings.logo_header == blank and section.settings.logo_header_dark == blank %}
            <span class="h2">{{ shop.name }}</span>
          {% endif %}
        </a>
      </div>

      {% comment %} RIGHT: ICONS {% endcomment %}
      <div class="i-header-container__content--icons">
        <div id="search-icon-bubble" class="header__icon-wrapper search-btn">
          {% render 'icon-search' %}
        </div>

        <a href="/account" class="header__icon-wrapper account-btn">
          {% render 'icon-account' %}
        </a>

        <div id="icon-minicart" class="header__icon-wrapper cart-btn">
          <i-minicart blocks="65|" />
        </div>
      </div>

    </div>
  </div>
</header>

{% render 'search-drawer' %}

<style>
  .section-header {
    height: {{ section.settings.container_height }}px;
  }
</style>

{% schema %}
{
  "name": "t:sections.header.name",
  "class": "shopify-section-header",
  "settings": [
    {
      "type": "link_list",
      "id": "menu",
      "default": "main-menu",
      "label": "t:sections.header.settings.menu.label"
    },
    {
      "type": "image_picker",
      "id": "logo_header",
      "label": "Logo header (Claro)"
    },
    {
      "type": "image_picker",
      "id": "logo_header_dark",
      "label": "Logo header (Oscuro)"
    },
    {
      "type": "checkbox",
      "id": "background_enabled",
      "label": "Habilitar fondo de color",
      "default": false
    },
    {
      "type": "select",
      "id": "transparent_pages",
      "label": "PÃ¡ginas con header transparente",
      "options": [
        { "value": "none", "label": "Ninguna" },
        { "value": "home", "label": "Solo inicio" },
        { "value": "home_collection", "label": "Inicio y colecciones" },
        { "value": "all", "label": "Todas" }
      ],
      "default": "home"
    },
    {
      "type": "range",
      "id": "container_height",
      "min": 40,
      "max": 150,
      "step": 2,
      "unit": "px",
      "label": "Altura del header",
      "default": 80
    }
  ]
}
{% endschema %}
